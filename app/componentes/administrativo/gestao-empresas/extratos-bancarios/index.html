<!-- 
/*
 *  Atos Capital - www.atoscapital.com.br
 *  
 *  suporte@atoscapital.com.br
 *
 */
-->

<div class="container" ng-controller="administrativo-extratos-bancariosCtrl" ng-init="administrativo_extratosBancariosInit()">    
    <!-- BEGIN PAGE BREADCRUMB -->
    <ul class="page-breadcrumb breadcrumb">
        <li>
            <a href="javascript:;" ng-click="goHome()">Início</a><i class="fa fa-circle"></i>
        </li>
        <li class="active">
             Administrativo<i class="fa fa-caret-right"></i>
             Gestão de Empresas<i class="fa fa-caret-right"></i>
             Extratos Bancários
        </li>
    </ul>
    <!-- END PAGE BREADCRUMB -->
    <div class="row">
        <div class="col-md-12">
            <!-- BEGIN TABLE PORTLET-->
            <div class="portlet light">
				 
                <div class="portlet-title">
                    <div class="caption">								
                        <span class="caption-subject font-green-sharp bold uppercase">Conta Corrente</span>						
                    </div>                    
                </div>
                <div class="portlet-body">
                    <div id="datatable_ajax_wrapper" class="dataTables_wrapper dataTables_extended_wrapper no-footer">
                        <div class="row">                       
                            <div class="col-md-8 col-sm-12">
                                <div class="dataTables_paginate paging_bootstrap_extended" id="datatable_ajax_paginate">
                                </div>
                                <div class="dataTables_info" id="datatable_ajax_info" role="status" aria-live="polite">
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-12">
                                <div class="table-group-actions pull-right">
                                    <span> </span>
                                </div>
                            </div>
                        </div>
                        <!--div class="table-scrollable"-->
                        <div class="table-scrollable">
                            <table class="table table-striped table-bordered table-hover dataTable no-footer conteudoTabelas" id="datatable_ajax" aria-describedby="datatable_ajax_info" role="grid">
                                <thead>
                                    <tr role="row" class="heading">
                                        <th width="10%" tabindex="0" rowspan="1" colspan="1">
                                             Contas Correntes 
                                        </th>                                        
                                        <th width="1%" tabindex="3" rowspan="1" colspan="1">
                                             Upload
                                        </th>
                                    </tr>
                                    <tr role="row" class="filter">   
                                        <!-- CONTAS CORRENTES -->
                                        <td rowspan="1" colspan="1" style="text-align: center">
                                            <select class="form-control form-filter input-sm filtros"
                                                    ng-disabled="contas.length == 0"
                                                    ng-model="filtro.conta"
                                                    ng-change="alterouConta()"
                                                    ng-options="conta as getNomeAmigavelConta(conta) for conta in contas">
                                                <!--option value="">Todas</option-->
                                            </select>
                                            <i class="fa fa-question-circle"
                                               ng-show="!usuariologado.grupoempresa"
                                               popover-placement="bottom"
                                               popover="É necessário selecionar uma empresa"
                                               popover-trigger="mouseenter"></i>
                                        </td>
                                        <!--UPLOAD-->
                                        <td rowspan="1" colspan="1">                                    
                            
                                            <div class="col-sm-12">
                                                <button class="btn btn-primary" ngf-select ngf-change="upload($files)" 
                                                        ngf-multiple="false" accept=".ofx"
                                                        ng-disabled="uploadEmProgresso()"
                                                        ng-show="filtro.conta && $filtro.conta !== null">
                                                    <i class="fa fa-spinner" 
                                                       ng-show="uploadEmProgresso()"/>
                                                    Selecionar Extrato
                                                </button>
                                            </div>

                                            <div class="col-sm-12" style="margin-top: 10px">
                                                <progressbar class="progress-striped" 
                                                             value="progresso" type="{{type}}" 
                                                             ng-show="filtro.conta && $filtro.conta !== null"
                                                             ng-class="{active : uploadEmProgresso()}">
                                                    {{current}}/{{total}}
                                                </progressbar>
                                            </div>
                                              
                                        </td>                                      
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="row">
                            <div class="col-md-8 col-sm-12">
                                <div class="dataTables_paginate paging_bootstrap_extended">
                                </div>
                                <div class="dataTables_info">
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-12">
                            </div>
                        </div>
                    </div>
                </div>    		
            </div>
            <!-- END TABLE PORTLET-->
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <!-- BEGIN TABLE PORTLET-->
            <div class="portlet light">                
                <!-- TOPO : Nome 'Usuários' e botões de 'Opções' e FullScreen -->
                <div class="portlet-title">
                    <div class="caption">
                        <!--i class="fa fa-cogs font-green-sharp"></i-->
                        <span class="caption-subject font-green-sharp bold uppercase">Extratos Bancários</span>
                    </div>
                    <div class="actions">
                        <!-- FULLSCREEN -->
                        <a class="btn btn-circle btn-icon-only btn-default fullscreen" 
                           href="javascript:;" ng-click="fullScreenClick()"
                           title="{{telaEstaEmFullScreen() ? 'Tela Normal' : 'Tela Cheia'}}"></a>
                        <!-- OPÇÕES -->
                        <div class="btn-group element-hidden"> <!-- NÃO EXIBE PQ AINDA NÃO TEM WEBAPI -->
                            <a class="btn btn-default btn-circle" href="javascript:;" data-toggle="dropdown">
                            <i class="fa fa-share"></i> Opções <i class="fa fa-angle-down"></i>
                            </a>
                            <ul class="dropdown-menu pull-right">
                                <li>
                                    <a href="javascript:;">
                                    Export to Excel </a>
                                </li>
                                <li>
                                    <a href="javascript:;">
                                    Export to CSV </a>
                                </li>
                                <li>
                                    <a href="javascript:;">
                                    Export to XML </a>
                                </li>
                                <li class="divider">
                                </li>
                                <li>
                                    <a href="javascript:;">
                                    Print Invoices </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>                
                <div class="portlet-body" style="min-height:300px"> 
                    
                    <!-- ANO -->
                    <div class="row">
                        <div class="col-sm-4"></div>
                        <div class="col-sm-4"> 
                            <div class="pagination-panel centralizarPaginacao"> 
                                <a href="javascript:;" ng-click="setAnoAnterior()"
                                   class="btn btn-sm default prev"  
                                   title="{{anoAnterior()}}">
                                        <i class="fa fa-caret-left"></i>
                                </a>
                                <input type="text" class="pagination-panel-input form-control input-inline input-sm" 
                                       maxlength="4" style="text-align:center; margin: 0 5px;"
                                       ng-model="anoDigitado" valid-integer-number
                                       ng-keypress="($event.which === 13) ? alteraAno() : 0"
                                       ng-blur="atualizaAnoDigitado()">
                                <a href="javascript:;" ng-click="setAnoPosterior()"
                                   class="btn btn-sm default next"
                                   ng-class="{disabled: !temProximoAno()}"
                                   title="{{anoPosterior()}}">
                                    <i class="fa fa-caret-right"></i>
                                </a>
                            </div>
                        </div> 
                        <div class="col-sm-4"></div>
                    </div>
                    <!-- FIM ANO -->
                    
                    <!-- TABS -->
                    <div class="row" style="text-align:center; margin-top:20px">
                        <tabset type="pills">
                            <tab heading="Jan{{getAno()}}" select="setTab(1)" 
                                 disable="mes.janeiro.disabled" active="mes.janeiro.active"></tab>
                            <tab heading="Fev{{getAno()}}" select="setTab(2)" 
                                 disable="mes.fevereiro.disabled" active="mes.fevereiro.active"></tab>
                            <tab heading="Mar{{getAno()}}" select="setTab(3)" 
                                 disable="mes.marco.disabled" active="mes.marco.active"></tab>
                            <tab heading="Abr{{getAno()}}" select="setTab(4)" 
                                 disable="mes.abril.disabled" active="mes.abril.active"></tab>
                            <tab heading="Mai{{getAno()}}" select="setTab(5)" 
                                 disable="mes.maio.disabled" active="mes.maio.active"></tab>
                            <tab heading="Jun{{getAno()}}" select="setTab(6)" 
                                 disable="mes.junho.disabled" active="mes.junho.active"></tab>
                            <tab heading="Jul{{getAno()}}" select="setTab(7)" 
                                 disable="mes.julho.disabled" active="mes.julho.active"></tab>
                            <tab heading="Ago{{getAno()}}" select="setTab(8)" 
                                 disable="mes.agosto.disabled" active="mes.agosto.active"></tab>
                            <tab heading="Set{{getAno()}}" select="setTab(9)" 
                                 disable="mes.setembro.disabled" active="mes.setembro.active"></tab>
                            <tab heading="Out{{getAno()}}" select="setTab(10)" 
                                 disable="mes.outubro.disabled" active="mes.outubro.active"></tab>
                            <tab heading="Nov{{getAno()}}" select="setTab(11)" 
                                 disable="mes.novembro.disabled" active="mes.novembro.active"></tab>
                            <tab heading="Dez{{getAno()}}" select="setTab(12)" 
                                 disable="mes.dezembro.disabled" active="mes.dezembro.active"></tab>
                        </tabset>
                    </div>
                    
                    <!-- CONTEÚDO DO EXTRATO-->
                    <div class="row">
                        <div class="panel">
                            <div class="row conteudoMinhaConta">
                                <!-- TABLE RESPOSIVE -->
                                <div class="table-responsive" style="margin-left:15px">
                                    <table class="table table-hover table-light">
                                        <thead>
                                            <tr class="uppercase">
                                                <th>
                                                     Data movimento
                                                </th>
                                                <th>
                                                     Tipo
                                                </th>
                                                <th>
                                                     Descrição
                                                </th>
                                                <th>
                                                     Documento
                                                </th>
                                                <th>
                                                     Valor
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="movimentacao in extrato">
                                                <!-- DATA -->
                                                <td ng-bind="getDataString(movimentacao.dtExtrato)"
                                                    style="text-align:center">
                                                </td>
                                                <!-- TIPO -->
                                                <td style="text-align:center">                                                    
                                                    {{movimentacao.dsTipo}}                                                  
                                                </td>
                                                <!-- DESCRIÇÃO -->
                                                <td>
                                                     {{movimentacao.dsDocumento}}
                                                </td>
                                                <!-- DOCUMENTO -->
                                                <td style="text-align:center">
                                                     {{movimentacao.nrDocumento}}
                                                </td>
                                                <!-- VALOR -->
                                                <td style="text-align:center">
                                                    <span ng-class="{'statusPositivoValorExtrato' : movimentacao.vlMovimento >= 0.0, 'statusNegativoValorExtrato' : movimentacao.vlMovimento < 0.0}">
                                                        {{movimentacao.vlMovimento | currency:'R$'}}
                                                    </span>
                                                </td>
                                            </tr>
                                            <tr ng-hide="!filtro.conta || filtro.conta === null || extrato.length > 0">
                                                <td colspan="2"></td>
                                                <td>
                                                    <div class="col-sm-12" 
                                                         ng-class="{'element-hidden': !uploadEmProgresso()}">
                                                        <progressbar class="progress-striped" 
                                                                     value="progresso" type="{{type}}" 
                                                                     ng-show="filtro.conta && $filtro.conta !== null"
                                                                     ng-class="{active : uploadEmProgresso()}">
                                                            {{current}}/{{total}}
                                                        </progressbar>
                                                    </div>
                                                    <div ngf-drop ngf-select class="col-sm-12 drop-box"
                                                         ngf-drag-over-class="dragover" 
                                                         ngf-multiple="false" 
                                                         ngf-change="upload($files)"
                                                         ngf-allow-dir="true"
                                                         ng-disabled="uploadEmProgresso()"
                                                         accept=".ofx">
                                                        Arraste até aqui o extrato ou clique aqui para selecioná-lo
                                                    </div>
                                                </td>
                                                <td colspan="2"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- FIM TABLE RESPOSIVE -->
                            </div>  
                        </div>
                    </div>
                    <!-- FIM CONTEUDO -->
                </div>
                <!-- FIM PORTLET BODY -->
            </div> 
            <!-- FIM PORTLET LIGTH -->
        </div>
    </div>
</div>
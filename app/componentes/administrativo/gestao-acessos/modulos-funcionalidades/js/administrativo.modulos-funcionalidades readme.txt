# README #

Módulo que:
 - gerencia o layout da tela de módulos (controllers) e funcionalidades (methods) da Gestão de acessos (app/componentes/administrativo/gestao-acessos/modulos-funcionalidades/index.html);
 - permite criação e exclusão de um módulo
 - permite também a inserção/alteração das funcionalidades de cada módulo
 

### Pra Que Serve Este Módulo? ###

Gerenciar completamente a tela de módulos e funcionalidades da Gestão de acessos.  



### O que é necessário para usar o módulo? ###

Como esse é um controller filho do controller principal "appCtrl" (app.js), ele herda todos os módulos importados por ele.
Além deles, é necessária a importação dos seguintes módulos externos.

 |----------------------------------------|---------------------------------------------------|-------------------------------------------|
 |                MODULO                  |                   DESCRIÇÃO                       |         IMPORT (no app/index.html)        |
 |----------------------------------------|---------------------------------------------------|-------------------------------------------|
 |         jsTree.directive               | Diretiva <jstree>, que permite usar o jstree do   |                jstree.min.js              |
 |                                        | JQuery (estrutura de pastas - árvore              |             jsTree.directive.js           |
 |----------------------------------------|---------------------------------------------------|-------------------------------------------|


 
### Outras depêndencias ###

  * Evento "mudancaDeRota", proveniente do "appCtrl", para de fato modificar a rota/estado
  * $scope.token do "appCtrl"
  * Emite evento "acessouTela" no init do controller para que seja feito o log de acesso de tela
  * Evento "acessoDeTelaNotificado", proveniente do "appCtrl", para de fato exibir a tela e fazer requisições 
	=> importante para o log correto de requisições HTTP, ao qual identifica corretamente a (tela de) origem
  * APIS:
    - administracao/logacesso
    - administracao/webpagescontrollers
    - administracao/webpagesmethods
	
 
 
 ### Interação com a WEB API ###
 
  * api/administracao/webpagescontrollers
	 - DELETE : deleta um controller    
				  ?token=...&id_controller=id  OBS: remove todos os controllers filhos (=> todos os métodos associados)
	 - GET  : listagem de todos módulos (controllers), com suas respectivas funcionalidades (methods) (coleção 2)
			  Aqueles métodos ao qual a role tem acesso, terá o id 'selecionado' com valor igual a 'true'
	          [{ id_controller : int,
				ds_controller: string
				methods : [{ id_method : int,
							 ds_method : string,
							}] // ORDER BY DS_METHOD
				subcontrollers : [{ id_controller : int
									ds_controller: string
									methods : [{ id_method : int,
												 ds_method : string
												}] // ORDER BY DS_METHOD
									subcontrollers : [{ id_controller : int
														ds_controller: string,
														methods : [{ id_method : int,
																	 ds_method : string
																	}] // ORDER BY DS_METHOD
														subcontrollers : [] // só vai até o terceiro nível	
														}]	
									}]
			  }] // ORDER BY DS_CONTROLLER
	- POST : novo módulo (controller)
				{	webpagescontrollers: { ds_controller : string
										   id_subController : int // essa informação pode ser enviada ou não
										 }
					methodspadrao : bool // indica se é para cadastrar os métodos padrão (Atualização / Cadastro / Leitura / Remoção)
				}
			 // obtém como resposta o id_controller
	- PUT : altera o nome de exibição de um módulo ou o pai ao qual ele é filho
				{ id_controller : int,
				  ds_controller : string,
				  id_subController : int ou null
				}
				
	OBSERVAÇÕES : Cadastrar ou Alterar um controller implica em: 
	               => Alterar o código do portal (index e javascripts para o módulo, considerando o ds_controller)
				   => Adicionar do lado da webapi, na classe Negocios/GatewayModulo
	
				
  * api/administracao/webpagesmethods
     - DELETE : deleta uma funcionalidade (method)    
				  ?token=...&id_method=id  OBS: remove todos as permissões associadas
	 - POST : nova funcionalidade (method)
				{ ds_method : string 
				  id_controller : int // essa informação pode ser enviada ou não
				}
			 // obtém como resposta o id_method
			 OBS: Não é possível armazenar o método "Filtro Empresa" em outro lugar que não seja Administrativo
	 - PUT : altera o nome de exibição de uma funcionalidade (method)
				{ id_method : int,
				  ds_method : string
				}

 
   

   
### Desenvolvedores ###

Deivid Marinho - deividgfmarinho@gmail.com